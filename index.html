<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¨Ø§ Ú†Ù‡ Ù…Ø¨Ù„ØºÛŒ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…ØŸ</title>
    <style>
        :root { --primary: #1e40af; --secondary: #64748b; --success: #059669; --danger: #be123c; --group-bg: #f1f5f9; }
        body { font-family: Tahoma, sans-serif; background: #e5e7eb; padding: 20px; direction: rtl; }
        .container { max-width: 1050px; margin: auto; background: white; padding: 30px; border-radius: 25px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); position: relative; }
        .main-title { text-align: center; color: var(--primary); margin-bottom: 25px; font-size: 1.8rem; font-weight: bold; }
        
        .price-info-banner { 
            background: linear-gradient(90deg, #1e3a8a, #3b82f6); 
            color: white; padding: 20px; border-radius: 15px; margin-bottom: 25px; 
            line-height: 1.8; text-align: center; font-size: 1.1rem;
        }
        .price-info-banner strong { color: #ffd600; font-size: 1.3rem; }

        .btn-group { text-align: center; margin-bottom: 25px; }
        button { cursor: pointer; border: none; padding: 12px 25px; border-radius: 10px; font-family: Tahoma; transition: 0.3s; font-weight: bold; margin: 0 5px; }
        .btn-auto { background: var(--success); color: white; }
        .btn-manual { background: var(--secondary); color: white; }
        .btn-calc { background: #f59e0b; color: white; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th { background: #f8fafc; color: #475569; padding: 15px; font-size: 0.85rem; border-bottom: 2px solid #e2e8f0; }
        td { padding: 12px; text-align: center; border-bottom: 1px solid #f1f5f9; font-weight: bold; }
        .category-row { background: var(--group-bg); color: var(--primary); font-weight: 800; text-align: right; padding-right: 20px; font-size: 1rem; }
        .toman-cell { color: var(--danger); }
        .gift-cell { color: var(--success); }
        .comm-cell { color: #7c3aed; }
        .small-toman { display: block; font-size: 0.75rem; opacity: 0.8; font-weight: normal; margin-top: 4px; color: #64748b; }

        /* Ù¾Ø§Ù¾ Ø¢Ù¾ Ù‡Ø§ */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); }
        .modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 20px; width: 450px; text-align: right; position: relative; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); line-height: 1.6; }
        .close { position: absolute; left: 20px; top: 15px; font-size: 28px; cursor: pointer; color: #aaa; }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ø§Ø®ØªØµØ§ØµÛŒ */
        .calc-modal { width: 350px !important; text-align: center !important; }
        .calc-modal input { width: 90%; padding: 12px; margin: 15px 0; border: 2px solid #ddd; border-radius: 10px; text-align: center; font-size: 1.1rem; font-family: Tahoma; }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù„ÛŒØ³Øª Ø±Ø§Ù‡Ù†Ù…Ø§ */
        .guide-list { list-style: none; padding: 0; }
        .guide-list li { margin-bottom: 15px; padding-right: 30px; position: relative; font-size: 0.95rem; }
        .guide-list li::before { content: 'ğŸ”¹'; position: absolute; right: 0; top: 2px; }
        .btn-got-it { background: var(--primary); color: white; width: 100%; margin-top: 20px; padding: 15px; font-size: 1rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="main-title">Ø¨Ø§ Ú†Ù‡ Ù…Ø¨Ù„ØºÛŒ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒÙ…ØŸ</div>

    <div class="price-info-banner" id="price-banner">Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø²Ø§Ø±...</div>

    <div class="btn-group">
        <button class="btn-auto" onclick="fetchPrice()">Ø¢Ù¾Ø¯ÛŒØª Ø§Ø² Ø¨Ø§Ø²Ø§Ø±</button>
        <button class="btn-manual" onclick="setManualPrice()">ÙˆØ±ÙˆØ¯ Ù‚ÛŒÙ…Øª Ø¯Ø³ØªÛŒ</button>
        <button class="btn-calc" onclick="toggleModal('calcModal', true)">ğŸ–© Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ø³Ø±ÛŒØ¹</button>
    </div>

    <table>
        <thead>
            <tr>
                <th>Ù‚ÛŒÙ…Øª Ù¾Ú© ($)</th>
                <th>+Û±ÛµÙª Ú¯Ù…Ø±Ú©ÛŒ ($)</th>
                <th>Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ (ØªÙˆÙ…Ø§Ù†)</th>
                <th>Ù‡Ø¯Ø§ÛŒØ§ÛŒ Ù…Ø­ØµÙˆÙ„ÛŒ ($)</th>
                <th>Ù¾ÙˆØ±Ø³Ø§Ù†Øª Ø¯Ø±ÛŒØ§ÙØªÛŒ (Ø¨Ø§ Ú©Ø³Ø± ÙˆÙˆÚ†Ø±) ($)</th>
            </tr>
        </thead>
        <tbody id="table-body"></tbody>
    </table>
</div>

<div id="guideModal" class="modal" style="display: block;">
    <div class="modal-content">
        <h3 style="color: var(--primary); text-align: center; border-bottom: 2px solid #eee; padding-bottom: 10px;">ğŸ’¡ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØµÙØ­Ù‡</h3>
        <ul class="guide-list">
            <li><strong>Ù‚ÛŒÙ…Øª ØªØªØ±:</strong> Ù‚ÛŒÙ…Øª Ø¨Ø§Ø²Ø§Ø± Ø¨Ù‡ ØµÙˆØ±Øª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¨Ø±Ø§ÛŒ Ø§Ù…Ù†ÛŒØª Ù…Ø¹Ø§Ù…Ù„Ø§ØªØŒ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ø§ Ø¨Ø§ <b>Û².ÛµÙª Ú©Ø§Ø±Ù…Ø²Ø¯</b> Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø¨Ø§Ø²Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
            <li><strong>Ú¯Ù…Ø±Ú©ÛŒ:</strong> Ø¨Ù‡ Ù‚ÛŒÙ…Øª Ù‡Ø± Ù¾Ú©ØŒ <b>Û±ÛµÙª Ù‡Ø²ÛŒÙ†Ù‡ Ú¯Ù…Ø±Ú©ÛŒ</b> Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ Ùˆ Ø¯Ø± Ø³ØªÙˆÙ† Ø¯ÙˆÙ… Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
            <li><strong>Ù‡Ø¯Ø§ÛŒØ§ Ùˆ Ù¾ÙˆØ±Ø³Ø§Ù†Øª:</strong> Ø¯Ø± Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø¢Ø®Ø±ØŒ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ù„Ø§Ø±ÛŒ Ùˆ Ù…Ø¹Ø§Ø¯Ù„ ØªÙˆÙ…Ø§Ù†ÛŒ Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ù…ÛŒâ€ŒØ¨ÛŒÙ†ÛŒØ¯. Ù¾ÙˆØ±Ø³Ø§Ù†Øªâ€ŒÙ‡Ø§ Ø¨Ø§ <b>Ú©Ø³Ø± Û±Û°Ùª ÙˆÙˆÚ†Ø±</b> Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.</li>
            <li><strong>Ø¢Ù¾Ø¯ÛŒØª Ø¨Ø§Ø²Ø§Ø±:</strong> Ø§ÛŒÙ† Ø¯Ú©Ù…Ù‡ Ù‚ÛŒÙ…Øª Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø§Ø² ØµØ±Ø§ÙÛŒ Ø¯Ø±ÛŒØ§ÙØª Ùˆ Ø¬Ø¯ÙˆÙ„ Ø±Ø§ Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</li>
            <li><strong>Ù‚ÛŒÙ…Øª Ø¯Ø³ØªÛŒ:</strong> Ø§Ú¯Ø± Ù†ÙˆØ³Ø§Ù† Ø¨Ø§Ø²Ø§Ø± Ø²ÛŒØ§Ø¯ Ø¨ÙˆØ¯ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù‚ÛŒÙ…Øª Ù…Ø¯Ù†Ø¸Ø± Ø®ÙˆØ¯ØªØ§Ù† Ø±Ø§ Ø¯Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</li>
            <li><strong>Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨:</strong> Ø¨Ø±Ø§ÛŒ Ù…Ø¨Ø§Ù„ØºÛŒ Ú©Ù‡ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ Ù†ÛŒØ³ØªÙ†Ø¯ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ Ù†Ø§Ø±Ù†Ø¬ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
        </ul>
        <button class="btn-got-it" onclick="toggleModal('guideModal', false)">Ù…ØªÙˆØ¬Ù‡ Ø´Ø¯Ù…</button>
    </div>
</div>

<div id="calcModal" class="modal">
    <div class="modal-content calc-modal">
        <span class="close" onclick="toggleModal('calcModal', false)">&times;</span>
        <h3 style="color: var(--primary)">Ù…Ø§Ø´ÛŒÙ†â€ŒØ­Ø³Ø§Ø¨ Ú¯Ù…Ø±Ú©ÛŒ</h3>
        <input type="number" id="calcInput" placeholder="Ù…Ø¨Ù„Øº Ø¨Ù‡ Ø¯Ù„Ø§Ø±" oninput="quickCalc()">
        <div style="background: #f9fafb; padding: 15px; border-radius: 10px; border: 1px solid #eee;">
            <div style="margin-bottom:10px">Ø¨Ø§ Û±ÛµÙª Ú¯Ù…Ø±Ú©ÛŒ: <span id="resUsd" style="color:var(--primary)">0</span> $</div>
            <div style="color:var(--danger)">Ù…Ø¹Ø§Ø¯Ù„ ØªÙˆÙ…Ø§Ù†ÛŒ:<br><span id="resToman" style="font-size:1.3rem">0</span> ØªÙˆÙ…Ø§Ù†</div>
        </div>
    </div>
</div>

<script>
    const groups = [
        { name: "Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø§ÙˆÙ„: ÛŒÚ© Ø¬Ø§ÛŒÚ¯Ø§Ù‡", items: [{p: 100, g: 0, c: 0}, {p: 300, g: 115, c: 0}, {p: 500, g: 230, c: 0}]},
        { name: "Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø¯ÙˆÙ…: Ø³Ù‡ Ø¬Ø§ÛŒÚ¯Ø§Ù‡", items: [{p: 700, g: 460, c: 16}, {p: 1100, g: 690, c: 48}, {p: 1500, g: 920, c: 80}]},
        { name: "Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ø³ÙˆÙ…: Ù¾Ù†Ø¬ Ø¬Ø§ÛŒÚ¯Ø§Ù‡", items: [{p: 900, g: 460, c: 32}, {p: 1300, g: 690, c: 64}, {p: 1700, g: 920, c: 96}, {p: 2100, g: 1150, c: 128}, {p: 2500, g: 1380, c: 160}]},
        { name: "Ø¯Ø³ØªÙ‡ Ø¨Ù†Ø¯ÛŒ Ú†Ù‡Ø§Ø±Ù…: Ù‡ÙØª Ø¬Ø§ÛŒÚ¯Ø§Ù‡", items: [{p: 1900, g: 1380, c: 144}, {p: 2700, g: 1840, c: 272}, {p: 3500, g: 2300, c: 400}]}
    ];

    let globalCalcPrice = 0;

    async function fetchPrice() {
        try {
            const res = await fetch(`https://api.tetherland.com/currencies?v=${Date.now()}`);
            const data = await res.json();
            updateAll(parseInt(data.data.currencies.USDT.price));
        } catch (e) { alert("Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ù‚ÛŒÙ…Øª."); }
    }

    function setManualPrice() {
        const val = prompt("Ù‚ÛŒÙ…Øª ØªØªØ± (ØªÙˆÙ…Ø§Ù†):", "70000");
        if(val) updateAll(parseInt(val));
    }

    function updateAll(marketPrice) {
        globalCalcPrice = marketPrice * 1.025;
        document.getElementById('price-banner').innerHTML = `Ù‚ÛŒÙ…Øª ØªØªØ± Ø¯Ø± Ø¨Ø§Ø²Ø§Ø± Ú©Ù†ÙˆÙ†ÛŒ <strong>${marketPrice.toLocaleString()}</strong> ØªÙˆÙ…Ø§Ù† Ø§Ø³Øª Ùˆ Ù…Ø¨Ù†Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ø§ Û²,Ûµ Ø¯Ø±ØµØ¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² Ø¢Ù†Ø› ÛŒØ¹Ù†ÛŒ <strong>${Math.round(globalCalcPrice).toLocaleString()}</strong> ØªÙˆÙ…Ø§Ù†.`;
        
        const tbody = document.getElementById('table-body');
        tbody.innerHTML = '';

        groups.forEach(group => {
            tbody.innerHTML += `<tr><td colspan="5" class="category-row">${group.name}</td></tr>`;
            group.items.forEach(item => {
                const customs = item.p * 1.15;
                const totalToman = customs * globalCalcPrice;
                const giftToman = item.g * globalCalcPrice;
                const commAfterVoucher = item.c * 0.9;
                const commToman = commAfterVoucher * globalCalcPrice;

                tbody.innerHTML += `
                    <tr>
                        <td>$${item.p.toLocaleString()}</td>
                        <td>$${customs.toLocaleString()}</td>
                        <td class="toman-cell">${Math.round(totalToman).toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                        <td class="gift-cell">$${item.g.toLocaleString()} <span class="small-toman">(${Math.round(giftToman).toLocaleString()} Øª)</span></td>
                        <td class="comm-cell">${commAfterVoucher.toLocaleString(undefined, {minimumFractionDigits: 1})} <span class="small-toman">(${Math.round(commToman).toLocaleString()} Øª)</span></td>
                    </tr>`;
            });
        });
        quickCalc();
    }

    function toggleModal(id, show) {
        document.getElementById(id).style.display = show ? 'block' : 'none';
    }

    function quickCalc() {
        const val = document.getElementById('calcInput').value;
        if(val > 0) {
            const withCustoms = val * 1.15;
            const toman = withCustoms * globalCalcPrice;
            document.getElementById('resUsd').innerText = withCustoms.toLocaleString();
            document.getElementById('resToman').innerText = Math.round(toman).toLocaleString();
        } else {
            document.getElementById('resUsd').innerText = '0';
            document.getElementById('resToman').innerText = '0';
        }
    }

    // Ø¨Ø³ØªÙ† Ù¾Ø§Ù¾ Ø¢Ù¾ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø¨ÛŒØ±ÙˆÙ† Ø§Ø² Ø¢Ù†
    window.onclick = function(event) {
        if (event.target.className === 'modal') {
            event.target.style.display = 'none';
        }
    }

    fetchPrice();
</script>
</body>
</html>
